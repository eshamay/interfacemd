#include <iostream>
#include "../xyzsystem.h"
#include "../utility.h"
#include <string>

using namespace std;

int main () {

	XYZSystem sys ("pos.xyz", VecR(12.0, 12.0, 20.0), "wanniers");

	for (int step = 0; step < 1000; step++) {

		RUN (sys.Molecules()) {
			Molecule * mol = sys.Molecules(i);
			mol->CalcDipole();
			double mag = mol->Dipole().Magnitude();
			printf ("% 8.3f\n", mag * 4.0824);
		}

	sys.LoadNext();
	}

return 0;
}
